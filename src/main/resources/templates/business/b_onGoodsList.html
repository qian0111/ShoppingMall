<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
	<meta charset="utf-8">
	<title></title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="../static/layui/css/layui.css">
    <!-- Styles -->
    <link href="../static/css/fontawesome-all.min.css" rel="stylesheet">
    <link href="../static/css/themify-icons.css" rel="stylesheet">
    <link href="../static/css/sidebar.css" rel="stylesheet">
    <link href="../static/css/bootstrap.min.css" rel="stylesheet">
    <link href="../static/css/nixon.css" rel="stylesheet">
    <link href="../static/css/lobipanel.min.css" rel="stylesheet">
    <link href="../static/css/style.css" rel="stylesheet">
</head>
<body>
	<div class="main">
		<div class="container-fluid">
			<div class="row">
				<div class="col-lg-12">
					<div class="card alert col-lg-12">				
                    	<div class="card-body">
                    		<form action="onGoodsListPage" method="POST">
                    			<div class="col-lg-3 p-0">
				        			<div class="page-header">
				        				<div class="page-title">
											<h1><input type="text" placeholder="请输入商品名" class="form-control" name="gName" th:value="${gName}"></h1>
				        				</div>
				        			</div>
				    			</div>
			    				<div class="col-lg-3 p-0">
			       					 <div class="page-header">
							            <div class="page-title">                            
							               <h1>
							               	<select id="firstCategory" class="form-control"  name="firstCategory" onchange="secondCategory()">
												<option selected="selected" value="">一级分类</option>
												<option th:each="firstCategory:${firstCategories}"
														th:value="${firstCategory.firstCId}"
														th:text="${firstCategory.firstCName}"
														th:selected="${firstCategory.firstCId eq goods.firstCId} ? 'selected' : '' "></option>
											</select>
										  </h1>
							           </div>
			        				</div>
			    				</div>
								<div class="col-lg-3 p-0">
									 <div class="page-header">
								        <div class="page-title">                            
								           <h1>
								           	<select class="form-control"  name="secondCategory">
								           		<option selected="selected" value="">二级分类</option>
												<option th:each="secondCategory:${secondCategories}"
														th:value="${secondCategory.secondCId}"
														th:text="${secondCategory.secondCName}"
														th:selected="${secondCategory.secondCId eq goods.secondCId} ? 'selected' : '' "></option>
								           	</select>
										  </h1>
								       </div>
									</div>
								</div>
			   					<div class="col-lg-3 p-0">
					        		<div class="page-header">
					           			<div class="page-title">                            
					                		<h1 style="width: 100px;">
					                		<button class="form-control btn-danger">查询</button>
					               			</h1>
					          			</div>
					        		</div>
			    				</div>                    			
                    		</form>                   		
						</div>		
					</div>				
				</div>
			</div><!-- row -->
			<div class="row">
				<div class="col-lg-12">              
                    <div class="card alert">
						<div class="card-header">
							<h4>商品列表</h4>                                                   
						</div>
						<br>
						<!--  <div class="card-body" style="height:400px;overflow-y: scroll;" > -->
						<div class="row">
                      	<div class="col-lg-2">
                      		<button class="btn btn-danger" onclick="offGoods()">一键下架</button>
							<button class="btn btn-danger" onclick="onGoods()">上架商品</button>
                      	</div>
						</div>
						<div class="card-body">
							<table class="table table-responsive table-hover">
								<colgroup>
									<col width="5%">
									<col width="5%">
									<col width="35%">
									<col width="10%">
									<col width="10%">
									<col width="15%">
									<col width="10%">
									<col width="10%">
								</colgroup>
								<thead>
									<tr>
										<th>
									  		<input type="checkbox" onclick="checkAll(this.checked);"/>
										</th>
										<th>编号</th>
										<th>名称</th>
										<th>单价</th>
										<th>库存</th>
										<th>分类编号</th>
										<th>分类名称</th>
										<th>操作</th>
									</tr>
								</thead>
								<tbody>
									<tr th:each="goods:${goodsList}">
										<td><input type="checkbox" name="g_box" value="1"/></td>
										<td th:text="${goods.id}"></td>
										<td th:text="${goods.gName}"></td>
										<td th:text="${goods.gPrice}"></td>
										<td th:text="${goods.gCount}"></td>
										<td th:text="${goods.cId}"></td>
										<td th:text="${goods.cName}"></td>
										<td><button class="btn btn-danger" type="button" onclick="upGoodsInfo()">更新</button></td>
									</tr>
								</tbody>
							</table>
							<div></div>
                     	</div>
						<div class="row">
							<div class="col-lg-12" id="lp" align="center"></div>
						</div>
					</div>                 
				</div>
            </div>
		</div>
	</div>
</body>
<script src="../static/js/jquery-1.9.1.min.js"></script>
<!-- /# content wrap -->
<script src="../static/js/jquery.min.js"></script>
<!-- jquery vendor -->
<script src="../static/js/jquery.nanoscroller.min.js"></script>
<!-- nano scroller -->
<script src="../static/js/sidebar.js"></script>
<!-- sidebar -->
<script src="../static/js/bootstrap.min.js"></script>
<!-- bootstrap -->
<script src="../static/js/d3.min.js"></script>
<script src="../static/js/topojson.js"></script>
<script src="../static/js/datamaps.world.min.js"></script>
<script src="../static/js/datamap-init.js"></script>
<script src="../static/js/lobipanel.js"></script>
<!-- // Datamap -->
<script src="../static/js/scripts.js"></script>
<script src="../static/layui/layui.js"></script>
<script script type="text/javascript" th:inline="javascript">
	//加载模块（组件）
	layui.use(['layer','laypage'], function(){
		//创建弹出层对象
		var layer = layui.layer;
		//创建分页对象
		var laypage = layui.laypage;
		//执行一个laypage实例
		laypage.render({
			elem: 'lp' //注意，这里的lp是id，不用加#号
		    ,count: [[${totalCount}]] //数据总数，从服务端得到
			,limit: [[${pageCount}]] //每页显示的条数，laypage将会借助 count 和 limit 计算出分页数。
			,curr: [[${pageNo}]]//起始页码
			,jump: function(obj, first){
				var pageNo = obj.curr;
				var pageCount = obj.limit;
				var url = "onGoodsListPage?pageNo=" + pageNo;
				url += "&pageCount="+ pageCount;
				url += "&"+$("form").serialize();
				console.info(url);
				//首次不执行
				if(!first){
	  				window.location.href = url;
	  				//ajax仅能用于前后端数据交互，不能用于页面跳转
				}
			}
		});
	});

	//根据一级框的结果联动二级框的内容
	function secondCategory(){

	}

	function upGoodsInfo(){		
		layer.open({
			type: 2,
			title: "更新商品信息",
			area: ['600px', '400px'],
			content: "b_upGoodsInfo.html"
		});
	}
	
	function onGoods(){		
		layer.open({
			type: 2,
			title: "上架商品",
			area: ['600px', '400px'],
			content: "b_onGoods.html"
		});
	}
	
	//选中所有复选框
	function checkAll(status){
		//查看标题栏复选框选中状态
		console.info(status);
		if(status == true){
			console.info("全选");
			$(":checkbox[name='g_box']").prop("checked", true);
		}
		if(status == false){
			console.info("全不选");
			$(":checkbox[name='g_box']").prop("checked", false);
		}

	}

	//一键下架
	function offGoods(){
		var arr = [];
		$(":checkbox[name='g_box']:checked").each(function(index,ele) {
			console.info(index+","+$(ele).val());
			arr[index] = $(ele).val();
	   });
	   // console.info(arr);
	   alert("下架商品id："+arr);
	}
</script>
</html>